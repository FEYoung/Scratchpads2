<?php

function bioblitz_site_block_info(){
	$blocks['bioblitz_tasks']= array(
	  'info' => t('BioBlitz Tasks'),
	  'status' => FALSE,
	  'region' => 'content',
	  'weight' => 0,
	  'visibility' => 1,
	);
	
	return $blocks;
}

function bioblitz_site_block_view($delta = ''){
	switch ($delta) {
		case 'bioblitz_tasks':
			$block = bioblitz_site_bioblitz_tasks_block_view();
			return $block;
			break;
	}
}

function bioblitz_site_bioblitz_tasks_block_view(){
	$block['subject'] = t('BioBlitz Tasks');
	
	$content = '';
	$items = array();
	$items[] = l('Add a record', 'bioblitz/add');
	
	$content .= theme('item_list', array('items' => $items));
	
	$block['content'] = $content;
	return $block;
}

function bioblitz_site_context_load_alter(&$context){
	if ($context->name == 'scratchpads_front_page'){
		//Remove the default Scratchpads blocks
		unset($context->reactions['block']['blocks']['views-front_page_blocks-block_1']);
		unset($context->reactions['block']['blocks']['views-front_page_blocks-block_2']);
		unset($context->reactions['block']['blocks']['views-front_page_blocks-block_3']);
		//Add our own blocks
		$context->reactions['block']['blocks']['bioblitz_site-bioblitz_tasks'] = array('module' => 'bioblitz_site', 'delta' => 'bioblitz_tasks', 'region' => 'content', 'weight' => 0);
	}
}

function bioblitz_site_menu_link_alter(&$item){
	$items_to_hide = array('biblio', 'darwincorelocation', 'darwincore', 'itis_term');
	if (in_array($item['link_path'], $items_to_hide)){
		$item['hidden'] = 1;
	}
	if($item['link_path'] == 'specimen_observation'){
		$item['link_title'] = 'Records';
		$item['weight'] = 0;
	}
}

function bioblitz_site__form_alter(&$form, &$form_state, $form_id){
	switch ($form_id){
		case 'user_register_form':
			bioblitz_site_form_alter_user_register($form, $form_state, $form_id);
			break;
	}
}

function bioblitz_site_form_alter_user_register(&$form, &$form_state, $form_id){
	$form['field_user_institution']['und'][0]['value']['#default_value'] = 'BioBlitz Participant';
	$form['field_user_institution']['und'][0]['value']['#description'] = 'If you are associated with a relevant instiutuion then you may name it here, otherwise leave as BioBlitz Participant';
	$form['field_user_taxonomic_interest']['und'][0]['value']['#description'] = 'If you have particular expertise in a taxonomic group state it here';
}