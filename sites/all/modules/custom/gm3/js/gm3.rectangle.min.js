(function(a){Drupal.GM3.rectangle=function(c){this.GM3=c;this.geodesic=false;this.followlineN=new google.maps.Polyline({geodesic:this.geodesic,clickable:false,path:[],strokeColor:"#787878",strokeOpacity:1,strokeWeight:2});this.followlineE=new google.maps.Polyline({geodesic:this.geodesic,clickable:false,path:[],strokeColor:"#787878",strokeOpacity:1,strokeWeight:2});this.followlineS=new google.maps.Polyline({geodesic:this.geodesic,clickable:false,path:[],strokeColor:"#787878",strokeOpacity:1,strokeWeight:2});this.followlineW=new google.maps.Polyline({geodesic:this.geodesic,clickable:false,path:[],strokeColor:"#787878",strokeOpacity:1,strokeWeight:2});this.firstclick=false;this.rectangles=new Array();if(this.GM3.libraries.rectangle.rectangles){for(var b in this.GM3.libraries.rectangle.rectangles){}}this.add_transfer_listeners()};Drupal.GM3.rectangle.prototype.active=function(){this.GM3.google_map.setOptions({draggableCursor:"pointer"});this.first_click=false;this.rectangles[this.rectangles.length]=new google.maps.Polygon({geodesic:this.geodesic,map:this.GM3.google_map,strokeColor:this.get_line_colour(),strokeOpacity:0.4,strokeWeight:3,path:[]});this.followlineN.setPath([]);this.followlineN.setMap(this.GM3.google_map);this.followlineE.setPath([]);this.followlineE.setMap(this.GM3.google_map);this.followlineS.setPath([]);this.followlineS.setMap(this.GM3.google_map);this.followlineW.setPath([]);this.followlineW.setMap(this.GM3.google_map)};Drupal.GM3.rectangle.prototype.event=function(c,b,l){switch(this.GM3.active_class){case"rectangle":switch(c){case"click":if(this.first_click){console.log("Second click")}else{this.first_click=b}break;case"mousemove":var m=this.rectangles[this.rectangles.length-1].getPath().getLength();if(m>=1){var g=this.rectangles[this.rectangles.length-1].getPath().getAt(m-1);var k=[g,b.latLng];this.followline1.setPath(k);var e=this.rectangles[this.rectangles.length-1].getPath().getAt(0);var h=[e,b.latLng];this.followline2.setPath(h)}break;case"rightclick":this.GM3.set_active_class("default");this.followline1.setMap(null);this.followline2.setMap(null);break}break;case"default":switch(c){case"click":if(l.getClass&&l.getClass()=="Polygon"){for(var d=0;d<this.rectangles.length;d++){this.rectangles[d].stopEdit()}for(var f=0;f<this.rectangles.length;f++){if(l==this.rectangles[f]){this.rectangles[f].runEdit()}}}else{for(var d=0;d<this.rectangles.length;d++){this.rectangles[d].stopEdit()}}break;case"rightclick":if(l.getClass&&l.getClass()!="Polygon"){for(var d=0;d<this.rectangles.length;d++){this.rectangles[d].stopEdit()}}break}break}};Drupal.GM3.rectangle.prototype.add_transfer_listeners=function(){for(var b=0;b<this.rectangles.length;b++){if(this.rectangles[b]){this.GM3.add_listeners_helper(this.rectangles[b])}}};Drupal.GM3.rectangle.prototype.get_line_colour=function(){switch(this.rectangles.length%8){default:case 0:return"#ff0000";case 1:return"#00ff00";case 2:return"#0000ff";case 3:return"#ffff00";case 4:return"#ff00ff";case 5:return"#00ffff";case 6:return"#000000";case 7:return"#ffffff"}}})(jQuery);