(function(a){Drupal.GM3.field_polyline=function(b){b.children.polyline.event=function(i,f,h){switch(this.GM3.active_class){case"polyline":switch(i){case"click":this.polylines[this.polylines.length-1].stopEdit();this.polylines[this.polylines.length-1].getPath().push(f.latLng);this.polylines[this.polylines.length-1].runEdit(true);this.update_field();break;case"mousemove":var e=this.polylines[this.polylines.length-1].getPath().getLength();if(e>=1){var d=this.polylines[this.polylines.length-1].getPath().getAt(e-1);var g=[d,f.latLng];this.followline.setPath(g)}break;case"rightclick":this.GM3.set_active_class("default");this.followline.setMap(null);this.update_field();break}break;case"default":switch(i){case"click":if(h.getClass&&h.getClass()=="Polyline"){for(var c=0;c<this.polylines.length;c++){this.polylines[c].stopEdit()}h.runEdit()}else{for(var c=0;c<this.polylines.length;c++){this.polylines[c].stopEdit()}}this.update_field();break}break}}};Drupal.GM3.polyline.prototype.update_field=function(){var d="";for(var c=0;c<this.polylines.length;c++){if(d.length){d+="\n"}var e=this.polylines[c].getPath();if(e.length>1){d+="POLYGON ((";for(var b=0;b<e.length;b++){if(b>0){d+=","}d+=e.b[b].lng()+" "+e.b[b].lat()}d+="))"}}a("."+this.GM3.id+"-polyline").val(d)}})(jQuery);