(function(a){Drupal.GM3.region=function(b){this.GM3=b;this.geo=new google.maps.Geocoder();this.countries=new Object();if(this.GM3.libraries.region.regions){this.add_polygons_by_ids(this.GM3.libraries.region.regions)}};Drupal.GM3.region.prototype.add_polygons_by_ids=function(f){if(typeof f!="object"){if(typeof f=="string"){f=new Array(f)}else{return}}var c=new Array();for(var e in f){if(this.countries[f[e]]==undefined){this.countries[f[e]]=new Array();c[c.length]=f[e]}else{this.remove_polygons_by_id(f[e])}}if(c.length){if(c.length>10){var b=c;var f=new Array();var g=-1;for(var e in b){if(e%10==0){g++;f[g]=new Array()}f[g][f[g].length]=b[e]}}else{var f=new Array(f)}var d=this;for(var e in f){a.getJSON(Drupal.settings.gm3_region.callback+"/"+f[e].join(","),function(q,r,p){for(var o in q){for(var n in q[o]){for(var m in q[o][n]["coordinates"]){for(var h in q[o][n]["coordinates"][m]){d.countries[n][d.countries[n].length]=d.GM3.children.polygon.add_polygon(q[o][n]["coordinates"][m][h],false)}}}}})}}};Drupal.GM3.region.prototype.remove_polygons_by_id=function(c){for(var b in this.countries[c]){this.countries[c][b].setMap(null)}this.countries[c]=undefined};Drupal.GM3.region.prototype.active=function(){this.GM3.google_map.setOptions({draggableCursor:"pointer"})};Drupal.GM3.region.prototype.event=function(e,c,d){switch(this.GM3.active_class){case"region":switch(e){case"click":var b=this;this.geo.geocode({location:c.latLng},function(f,h){if(h==="OK"){for(i in f){if(f[i].types[0]&&f[i].types[0]=="country"&&f[i].types[1]&&f[i].types[1]=="political"){var g=f[i].address_components[0]["short_name"];a.getJSON(Drupal.settings.gm3_region.callback2+"/"+c.latLng.toString()+"/"+g,function(j){if(j){b.add_polygons_by_ids(j);this.update_field()}})}}}});break;case"rightclick":this.GM3.set_active_class("default");break}break}}})(jQuery);