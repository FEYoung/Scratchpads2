(function(a){Drupal.GM3.field_region=function(b){b.children.region.event=function(f,d,e){switch(this.GM3.active_class){case"region":switch(f){case"click":var c=this;this.geo.geocode({location:d.latLng},function(g,j){if(j==="OK"){for(i in g){if(g[i].types[0]&&g[i].types[0]=="country"&&g[i].types[1]&&g[i].types[1]=="political"){var h=g[i].address_components[0]["short_name"];a.getJSON(Drupal.settings.gm3_region.callback2+"/"+d.latLng.toString()+"/"+h,function(k){if(k){c.add_polygons_by_id(k);c.update_field()}})}}}});break;case"rightclick":this.GM3.set_active_class("default");break}break}}};Drupal.GM3.region.prototype.update_field=function(){var c=new Array();for(var b in this.countries){if(this.countries[b]!=undefined){c[c.length]=b}}a("."+this.GM3.id+"-region").val(c)}})(jQuery);