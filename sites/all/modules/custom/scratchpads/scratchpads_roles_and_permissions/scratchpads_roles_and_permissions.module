<?php

/**
 * TESTING
 */
function scratchpads_roles_and_permissions_init(){
  scratchpads_roles_and_permissions_modules_enabled(FALSE);
}

/**
 * Implements hook_hook_info().
 */
function scratchpads_roles_and_permissions_hook_info(){
  return array(
    'scratchpads_default_permissions_alter' => array(
      'group' => 'scratchpads'
    ),
    'scratchpads_default_permissions' => array(
      'group' => 'scratchpads'
    )
  );
}

/**
 * Implements hook_modules_enabled().
 */
function scratchpads_roles_and_permissions_modules_enabled($modules){
  $default_permissions = module_invoke_all('scratchpads_default_permissions');
  drupal_alter('scratchpads_default_permissions', $default_permissions);
  dpm($default_permissions);
  foreach($default_permissions as $role => $permissions){
    // Load the role
    $role = user_role_load_by_name($role);
    if($role){
      user_role_change_permissions($role->rid, drupal_map_assoc($permissions));
    }
  }
}