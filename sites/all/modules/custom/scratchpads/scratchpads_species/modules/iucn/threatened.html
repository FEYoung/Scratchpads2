<html>
  <head> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script> 
    <script> 
      function check(){
	    var species = $('#how_threatened_is').get(0).value;
	    species = species.replace(' ','-');
		$.ajax({
		  dataType: "jsonp",
		  url: 'http://api.iucnredlist.org/index/species/'+species+".js",
		  success: function (row) {
			var id = row[0].species_id
			$("#summary").get(0).innerHTML = row[0].category + "...";
                        $.ajax({
			  dataType: "jsonp",
			  url: 'http://api.iucnredlist.org/details/'+id+"/0.js",
			  success: function (data) {
				  var blob = data[0].species_account;
				  $("#full_result").get(0).innerHTML = blob;
				  var cat = $('#red_list_category_title').get(0).innerHTML;
				  var code = $('#red_list_category_code').get(0).innerHTML;
				  var year = $('#modified_year').get(0).innerHTML;
				  var summary = ""+code+" - "+cat+" (updated "+year+")";
				  $('#full_result').hide()
				  $("#summary").get(0).innerHTML = summary;
				  $("#summary_justification").get(0).innerHTML = $('#justification').get(0).innerHTML;
				  $('#full_button').show()
			  }
			});
		  },
		  failure: function () {
		    alert("No species found.");
			$("#result").get(0).innerHTML = "---";
		  }
		});
      }
    </script> 
    <style> 
    body{
      padding: 5em;
    }
    body,div,input{
      font-family: sans-serif;
      font-size: large;
    }
    #summary{
	  font-size: xx-large;
	  font-weight: bold;
    }
    #show_all{
	  display: none;
    }
    #full_result, #full_button{
	  display: none;
	}
	h1,h2,.x_label{
	  color: #000044;
	}
    </style> 
  </head> 
  <body> 
	<label for="how_threatened_is">How Threatened Is...</label> 
	<input id="how_threatened_is" type="text" size="25" /> 
  	<input type="button" value="Find Out" onclick="check()"/> 
  	<div id="summary">???</div> 
  	<div id="summary_justification"></div> 
  	<input id="full_button" type="button" value="Show Full Account" onclick="$('#full_result').show(); $('#full_button').hide()"/> 
  	<div id="full_result"></div> 
  </body> 
</html>
