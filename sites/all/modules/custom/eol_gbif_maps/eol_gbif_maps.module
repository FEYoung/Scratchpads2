<?php

/**
 * Implementation of hook_gm3_alter().
 */
function eol_gbif_maps_gm3_map_alter($map){
  // We add special data to a google map on taxonomy term pages only.
  if($term = menu_get_object('taxonomy_term', 2) && $map['id'] == 'gm3-map'){
    // Now we need to calculate the GBIF taxon id for this term name, and then
    // add the eol/gbif library to the map.
    dpm($map);
    $map['libraries']['eol_gbif_maps_overlay'] = array(
      'module' => 'eol_gbif_maps'
    );
  }
}

/**
 * Implementation of hook_library().
 */
function eol_gbif_maps_library(){
  // Whether or not to use the minified versions of the code.
  $min = variable_get('gm3_use_minified', TRUE) ? '.min' : '';
  return array(
    'eol_gbif_maps_overlay' => array(
      'title' => t('EOL/GBIF taxon data overlay'),
      'website' => 'http://eol.org/',
      'version' => '1',
      'js' => array(
        array(
          'data' => drupal_get_path('module', 'eol_gbif_maps') . "/js/eol_gbif_maps$min.js"
        )
      )
    )
  );
}