<?php

/**
 * Simple API call that adds the necessary JavaScript headers to the page.
 */
function gmaps3_add($options = FALSE){
  // We add the library JS files only the first time this is called.
  static $added = FALSE;
  if(!$added){
    drupal_add_js('http://maps.google.com/maps/api/js?sensor=false', 'external');
    drupal_add_js(drupal_get_path('module', 'gmaps3') . '/js/gmaps3.js');
  }
  
  $added = TRUE;
}

/**
 * Implementation of hook_init().
 */
function gmaps3_init(){
  gmaps3_add();
}

/**
 * Implementation of hook_block_info().
 */
function gmaps3_block_info(){
  return array(
    'map' => array(
      'info' => t('Google Map'),
      'cache' => DRUPAL_CACHE_GLOBAL
    )
  );
}

/**
 * Implementation of hook_block_view().
 */
function gmaps3_block_view($delta = ''){
  switch($delta){
    case 'map':
    default:
      return array(
        'subject' => 'Google Map',
        'content' => '<div id="gmaps3" class="gmaps3">&nbsp;</div>'
      );
  }
}